(window.webpackJsonp=window.webpackJsonp||[]).push([[69],{1182:function(t,e,o){"use strict";o.r(e);var a=o(1),s=Object(a.a)({},(function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[o("p",[t._v("The theme will enable progressive web app support"),o("sup",{staticClass:"footnote-ref"},[o("a",{attrs:{href:"#footnote1"}},[t._v("[1]")]),o("a",{staticClass:"footnote-anchor",attrs:{id:"footnote-ref1"}})]),t._v(" by including "),o("a",{attrs:{href:"https://vuepress-theme-hope.github.io/v1/pwa/",target:"_blank",rel:"noopener noreferrer"}},[o("code",[t._v("vuepress-plugin-pwa1")]),o("OutboundLink")],1),t._v(".")]),t._v(" "),o("p",[t._v("If you do not need this feature or want to use other pwa plugins, you can set the "),o("code",[t._v("themeConfig.pwa")]),t._v(" to "),o("code",[t._v("false")]),t._v(" to disable the plugin.")]),t._v(" "),o("h2",{attrs:{id:"content-caching-and-updating"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#content-caching-and-updating"}},[t._v("#")]),t._v(" Content caching and updating")]),t._v(" "),o("p",[t._v("Service Worker "),o("sup",{staticClass:"footnote-ref"},[o("a",{attrs:{href:"#footnote2"}},[t._v("[2]")]),o("a",{staticClass:"footnote-anchor",attrs:{id:"footnote-ref2"}})]),t._v(" (SW for short) is mainly used to cache and proxy site content.")]),t._v(" "),o("p",[t._v("This plugin will automatically register Service Woker through "),o("code",[t._v("workbox-build")]),t._v(".")]),t._v(" "),o("p",[t._v("To better control what the Service Worker can pre-cache, the plugin provides the following configurations.")]),t._v(" "),o("p",[t._v("If you are an advanced user, you can also directly set "),o("code",[t._v("themeConfig.pwa.generateSwConfig")]),t._v(" to pass options to "),o("code",[t._v("workbox-build")]),t._v(".")]),t._v(" "),o("h3",{attrs:{id:"default-cache"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#default-cache"}},[t._v("#")]),t._v(" Default cache")]),t._v(" "),o("p",[t._v("By default, the plugin will pre-cache all files related to the site: "),o("code",[t._v("**/*.{html,js,css,svg}")])]),t._v(" "),o("p",[t._v("At the same time, the plugin will cache font files: "),o("code",[t._v("**/*.{woff,woff2,eot,ttf,otf}")]),t._v(".")]),t._v(" "),o("h3",{attrs:{id:"cache-control"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#cache-control"}},[t._v("#")]),t._v(" Cache Control")]),t._v(" "),o("p",[t._v("Based on the requirement of installable "),o("sup",{staticClass:"footnote-ref"},[o("a",{attrs:{href:"#footnote3"}},[t._v("[3]")]),o("a",{staticClass:"footnote-anchor",attrs:{id:"footnote-ref3"}})]),t._v(", the plugin provides related options for cache control.")]),t._v(" "),o("h4",{attrs:{id:"picture-cache"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#picture-cache"}},[t._v("#")]),t._v(" Picture Cache")]),t._v(" "),o("p",[t._v("You can cache site pictures by setting the "),o("code",[t._v("cachePic")]),t._v(" option to "),o("code",[t._v("true")]),t._v(".")]),t._v(" "),o("p",[t._v("If your site is not large and the pictures are mostly critical descriptions, and hope to be displayed in offline mode, it is recommended to set this option to "),o("code",[t._v("true")]),t._v(".")]),t._v(" "),o("div",{staticClass:"custom-block info"},[o("p",{staticClass:"custom-block-title"},[t._v("Image recognition")]),t._v(" "),o("p",[t._v("We recognize images by file extension. Any files ending with "),o("code",[t._v(".png")]),t._v(", "),o("code",[t._v(".jpg")]),t._v(", "),o("code",[t._v(".jpeg")]),t._v(", "),o("code",[t._v(".gif")]),t._v(", "),o("code",[t._v(".bmp")]),t._v(", "),o("code",[t._v(".webp")]),t._v(" will be regarded as images.")])]),t._v(" "),o("h4",{attrs:{id:"html-cache"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#html-cache"}},[t._v("#")]),t._v(" HTML cache")]),t._v(" "),o("p",[t._v("When your site is too large, you can set "),o("code",[t._v("themeConfig.pwa.cacheHTML")]),t._v(" to "),o("code",[t._v("false")]),t._v(" to cache only the homepage and 404 error pages.")]),t._v(" "),o("div",{staticClass:"custom-block tip"},[o("p",{staticClass:"custom-block-title"},[t._v("Why can these be removed?")]),t._v(" "),o("p",[t._v("Though VuePress generates HTML files through SSR"),o("sup",{staticClass:"footnote-ref"},[o("a",{attrs:{href:"#footnote4"}},[t._v("[4]")]),o("a",{staticClass:"footnote-anchor",attrs:{id:"footnote-ref4"}})]),t._v(" for all pages, these files are mainly used for SEO"),o("sup",{staticClass:"footnote-ref"},[o("a",{attrs:{href:"#footnote5"}},[t._v("[5]")]),o("a",{staticClass:"footnote-anchor",attrs:{id:"footnote-ref5"}})]),t._v(" and allow you to directly configure the backend without SPA"),o("sup",{staticClass:"footnote-ref"},[o("a",{attrs:{href:"#footnote6"}},[t._v("[6]")]),o("a",{staticClass:"footnote-anchor",attrs:{id:"footnote-ref6"}})]),t._v(" Visit any link.")]),t._v(" "),o("p",[t._v("VuePress is essentially a SPA. This means that you can enter from the homepage to access all pages normally only caching the homepage.")]),t._v(" "),o("p",[t._v("When your site has a large number of pages or content, and the volume is too large after including HTML files, you can consider setting this option to "),o("code",[t._v("false")]),t._v(", which can reduce the volume by about 40%. The disadvantage is that users can only enter through the homepage and then navigate to the corresponding page in an offline environment. Direct access to a link will prompt a web page error.")])]),t._v(" "),o("h4",{attrs:{id:"size-control"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#size-control"}},[t._v("#")]),t._v(" Size control")]),t._v(" "),o("p",[t._v("To prevent large files from being included in the pre-cache list, any files larger than 2MB or pictures larger than 1MB will be deleted.")]),t._v(" "),o("p",[t._v("You can customize the maximum file size of the cache (unit: KB) with the "),o("code",[t._v("themeConfig.pwa.maxSize")]),t._v(" option, or change the size limit of the picture (unit: KB) with "),o("code",[t._v("themeConfig.pwa.maxPicSize")]),t._v(".")]),t._v(" "),o("h3",{attrs:{id:"update-popup"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#update-popup"}},[t._v("#")]),t._v(" Update popup")]),t._v(" "),o("p",[t._v("We provide an update popup when new content is successfully downloaded.")]),t._v(" "),o("div",{staticClass:"custom-block tip"},[o("p",{staticClass:"custom-block-title"},[t._v("Custom popup")]),t._v(" "),o("p",[t._v("If you are not satisfied with the default popup component, you can write component and replace it by yourself. To do that, You need to register your popup component globally and pass the name of the component to the "),o("code",[t._v("popupComponent")]),t._v(" option.")])]),t._v(" "),o("h2",{attrs:{id:"manifest-file-generation"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#manifest-file-generation"}},[t._v("#")]),t._v(" Manifest file generation")]),t._v(" "),o("p",[t._v("To ensure the installability of PWA, the site needs to generate a manifest file and declare a valid manifest file address "),o("sup",{staticClass:"footnote-ref"},[o("a",{attrs:{href:"#footnote7"}},[t._v("[7]")]),o("a",{staticClass:"footnote-anchor",attrs:{id:"footnote-ref7"}})]),t._v(" through "),o("code",[t._v("link")]),t._v(".")]),t._v(" "),o("p",[t._v("The plugin will automatically generate the Manifest file "),o("code",[t._v("manifest.webmanifest")]),t._v(" for you in the output directory, and will also add the manifest address statement to each HTML "),o("code",[t._v("<head>")]),t._v(".")]),t._v(" "),o("p",[t._v("If you already have a "),o("code",[t._v("manifest.webmanifest")]),t._v(" or "),o("code",[t._v("manifest.json")]),t._v(" in "),o("code",[t._v(".vuepress/public")]),t._v(", the plugin will read and merge it into the final manifest.")]),t._v(" "),o("h3",{attrs:{id:"automatic-generation"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#automatic-generation"}},[t._v("#")]),t._v(" Automatic generation")]),t._v(" "),o("p",[t._v("The plugin will use the information from the VuePress plugin API and set the fallback for fields in manifest as much as possible. So you don’t need to set most of the manifest fields.")]),t._v(" "),o("p",[t._v("If the following fields are not set, they will try to fallback to the following preset value in order.")]),t._v(" "),o("table",[o("thead",[o("tr",[o("th",[t._v("Options")]),t._v(" "),o("th",[t._v("Default value")])])]),t._v(" "),o("tbody",[o("tr",[o("td",[t._v("name")]),t._v(" "),o("td",[o("code",[t._v("siteConfig.title")]),t._v(" || "),o("code",[t._v("themeConfig.title")]),t._v(" || "),o("code",[t._v("'Site'")])])]),t._v(" "),o("tr",[o("td",[t._v("short_name")]),t._v(" "),o("td",[o("code",[t._v("siteConfig.title")]),t._v(" || "),o("code",[t._v("themeConfig.title")]),t._v(" || "),o("code",[t._v("'Site'")])])]),t._v(" "),o("tr",[o("td",[t._v("description")]),t._v(" "),o("td",[o("code",[t._v("siteConfig.description")]),t._v(" || "),o("code",[t._v("themeConfig.description")]),t._v(" || "),o("code",[t._v("'A site built with vuepress-theme-hope'")])])]),t._v(" "),o("tr",[o("td",[t._v("lang")]),t._v(" "),o("td",[o("code",[t._v("siteConfig.locales['/'].lang")]),t._v(" || "),o("code",[t._v("themeConfig.locales['/'].lang")]),t._v(" || "),o("code",[t._v('"en-US"')])])]),t._v(" "),o("tr",[o("td",[t._v("start_url")]),t._v(" "),o("td",[o("code",[t._v("context.base")])])]),t._v(" "),o("tr",[o("td",[t._v("scope")]),t._v(" "),o("td",[o("code",[t._v("context.base")])])]),t._v(" "),o("tr",[o("td",[t._v("display")]),t._v(" "),o("td",[o("code",[t._v('"standalone"')])])]),t._v(" "),o("tr",[o("td",[t._v("theme_color")]),t._v(" "),o("td",[o("code",[t._v('"#46bd87"')])])]),t._v(" "),o("tr",[o("td",[t._v("background_color")]),t._v(" "),o("td",[o("code",[t._v("'#ffffff'")])])]),t._v(" "),o("tr",[o("td",[t._v("orientation")]),t._v(" "),o("td",[o("code",[t._v("'portrait-primary'")])])]),t._v(" "),o("tr",[o("td",[t._v("prefer_related_applications")]),t._v(" "),o("td",[o("code",[t._v("false")])])])])]),t._v(" "),o("p",[t._v("For complete configuration items, please see "),o("a",{attrs:{href:"https://github.com/vuepress-theme-hope/vuepress-theme-hope-v1/blob/main/packages/pwa/src/types/manifest.d.ts",target:"_blank",rel:"noopener noreferrer"}},[t._v("Manifest Type Definition File"),o("OutboundLink")],1)]),t._v(" "),o("h3",{attrs:{id:"manual-configuration"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#manual-configuration"}},[t._v("#")]),t._v(" Manual configuration")]),t._v(" "),o("p",[t._v("You can manually specify the contents of the manifest in the "),o("code",[t._v("themeConfig.pwa.manifest")]),t._v(" option.")]),t._v(" "),o("div",{staticClass:"custom-block tip"},[o("p",{staticClass:"custom-block-title"},[t._v("Priority")]),t._v(" "),o("p",[o("code",[t._v("themeConfig.pwa.manifest")]),t._v(" option has the highest priority, followed by manifest files that may exist in the "),o("code",[t._v("public")]),t._v(" folder.")])]),t._v(" "),o("p",[o("strong",[t._v("You should at least set a valid icon through "),o("code",[t._v("themeConfig.pwa.manifest.icons")]),t._v(" or other icon related options in the PWA plugin.")])]),t._v(" "),o("div",{staticClass:"custom-block warning"},[o("p",{staticClass:"custom-block-title"},[t._v("Note")]),t._v(" "),o("p",[t._v("The installability "),o("sup",{staticClass:"footnote-ref"},[o("a",{attrs:{href:"#footnote3"}},[t._v("[3:1]")]),o("a",{staticClass:"footnote-anchor",attrs:{id:"footnote-ref3:1"}})]),t._v(" specification requires at least one valid icon to be declared in the manifest.")]),t._v(" "),o("p",[t._v("So if you do not configure "),o("code",[t._v("themeConfig.pwa.manifest.icons")]),t._v(", visitors can only enjoy the offline accessibility brought by the Service Worker cache, while cannot install your site as a PWA.")]),t._v(" "),o("p",[t._v("Besides the plugin does not process anything in the manifest, but outputs them as-is. This means that if you plan to deploy to a subdirectory, you should add "),o("code",[t._v("base")]),t._v(" to the corresponding URL in the manifest yourself.")])]),t._v(" "),o("h2",{attrs:{id:"other-options"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#other-options"}},[t._v("#")]),t._v(" Other options")]),t._v(" "),o("p",[t._v("The plugin also provides other PWA-related options, such as Microsoft tile icon and color settings, Apple icon and so on.")]),t._v(" "),o("p",[t._v("You can set them as needed. For detailed options, please see "),o("a",{attrs:{href:"https://vuepress-theme-hope.github.io/v1/pwa/config.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("Configuration Page"),o("OutboundLink")],1),t._v(".")]),t._v(" "),o("h2",{attrs:{id:"further-reading"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#further-reading"}},[t._v("#")]),t._v(" Further Reading")]),t._v(" "),o("p",[t._v("For more details, please see:")]),t._v(" "),o("ul",[o("li",[o("a",{attrs:{href:"https://vuepress-theme-hope.github.io/v1/pwa/",target:"_blank",rel:"noopener noreferrer"}},[t._v("PWA plugin docs"),o("OutboundLink")],1)]),t._v(" "),o("li",[o("a",{attrs:{href:"https://web.dev/progressive-web-apps/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Google PWA"),o("OutboundLink")],1)]),t._v(" "),o("li",[o("a",{attrs:{href:"https://developer.mozilla.org/zh-CN/docs/Web/Progressive_web_apps",target:"_blank",rel:"noopener noreferrer"}},[t._v("MDN PWA"),o("OutboundLink")],1)]),t._v(" "),o("li",[o("a",{attrs:{href:"https://w3c.github.io/manifest/",target:"_blank",rel:"noopener noreferrer"}},[t._v("W3C Manifest Specification"),o("OutboundLink")],1)])]),t._v(" "),o("hr",{staticClass:"footnotes-sep"}),t._v(" "),o("section",{staticClass:"footnotes"},[o("ol",{staticClass:"footnotes-list"},[o("li",{staticClass:"footnote-item",attrs:{id:"footnote1"}},[o("p",[o("strong",[t._v("PWA introduction")])]),t._v(" "),o("p",[t._v("PWA, full name Progressive Web app. PWA standard is stipulated by W3C.")]),t._v(" "),o("p",[t._v("It allows sites to install the site as an App on supported platform through a browser that supports this feature. "),o("a",{staticClass:"footnote-backref",attrs:{href:"#footnote-ref1"}},[t._v("↩︎")])])]),t._v(" "),o("li",{staticClass:"footnote-item",attrs:{id:"footnote2"}},[o("p",[o("strong",[t._v("Service Worker Introduction")])]),t._v(" "),o("ol",[o("li",[o("p",[t._v("The Service Worker will get and cache all the files registered in it during the registration process.")])]),t._v(" "),o("li",[o("p",[t._v("After the registration complete, the Service Worker is activated, and starts to proxy and control all your requests.")])]),t._v(" "),o("li",[o("p",[t._v("Whenever you want to initiate an access request through the browser, the Service Worker will check whether it exists in its own cache list, if it exists, it will directly return the cached result, otherwise it will call its own fetch method to get it. You can use a custom fetch method to fully control the result of the request for resources in the web page, such as providing a fallback web page when offline.")])]),t._v(" "),o("li",[o("p",[t._v("Every time the user reopens the site, the Service Worker will request to the link when it was registered. If a new version of Service Woker is detected, it will update itself and start caching the list of resources registered in the new Service Worker . After the content update is successfully obtained, the Service Worker will trigger the "),o("code",[t._v("update")]),t._v(" event. The user can be notified through this event, for example, a pop-up window will be displayed in the lower right corner, prompting the user that new content is available and allowing the user to trigger an update.")])])]),t._v(" "),o("a",{staticClass:"footnote-backref",attrs:{href:"#footnote-ref2"}},[t._v("↩︎")])]),t._v(" "),o("li",{staticClass:"footnote-item",attrs:{id:"footnote3"}},[o("p",[o("strong",[t._v("Installable")])]),t._v(" "),o("p",[t._v("To let the site be registered as a PWA, the site needs to successfully register a valid service worker by itself, and at the same time add a valid manifest file and declare it.")]),t._v(" "),o("p",[t._v("Each platform or browser has requirements for the size of the Service Worker cache. When the file size of the Service Worker cache is too large, the site will be marked as not installable. For Safari, the threshold is 50 MB, a few browsers will set less or more values (30MB, 70MB, 80MB), and Chrome will mark the threshold at 100 MB.")]),t._v(" "),o("p",[t._v("The manifest file should contain at least "),o("code",[t._v("name")]),t._v(" (or "),o("code",[t._v("short_name")]),t._v(") "),o("code",[t._v("icons")]),t._v(" "),o("code",[t._v("start_url")])]),t._v(" "),o("p",[t._v("And starting from Chrome 93, Service Woker must contain effective fetch events to control offline requests. "),o("a",{staticClass:"footnote-backref",attrs:{href:"#footnote-ref3"}},[t._v("↩︎")]),t._v(" "),o("a",{staticClass:"footnote-backref",attrs:{href:"#footnote-ref3:1"}},[t._v("↩︎")])])]),t._v(" "),o("li",{staticClass:"footnote-item",attrs:{id:"footnote4"}},[o("p",[o("strong",[t._v("SSR")]),t._v(": "),o("strong",[t._v("S")]),t._v("erver "),o("strong",[t._v("S")]),t._v("ide "),o("strong",[t._v("R")]),t._v("endering, "),o("a",{staticClass:"footnote-backref",attrs:{href:"#footnote-ref4"}},[t._v("↩︎")])])]),t._v(" "),o("li",{staticClass:"footnote-item",attrs:{id:"footnote5"}},[o("p",[o("strong",[t._v("SEO")]),t._v(": "),o("strong",[t._v("S")]),t._v("earch "),o("strong",[t._v("E")]),t._v("ngine "),o("strong",[t._v("O")]),t._v("ptimization. For details, please see "),o("a",{attrs:{href:"https://mrhope.site/code/site/html/definition/seo/",target:"_blank",rel:"noopener noreferrer"}},[t._v("SEO Introduction"),o("OutboundLink")],1),t._v(" "),o("a",{staticClass:"footnote-backref",attrs:{href:"#footnote-ref5"}},[t._v("↩︎")])])]),t._v(" "),o("li",{staticClass:"footnote-item",attrs:{id:"footnote6"}},[o("p",[o("strong",[t._v("SPA")]),t._v(": "),o("strong",[t._v("S")]),t._v("ingle "),o("strong",[t._v("P")]),t._v("age "),o("strong",[t._v("A")]),t._v("pplication, most of them only have the homepage, and use history mode to handle routing instead of actually navigating between pages. "),o("a",{staticClass:"footnote-backref",attrs:{href:"#footnote-ref6"}},[t._v("↩︎")])])]),t._v(" "),o("li",{staticClass:"footnote-item",attrs:{id:"footnote7"}},[o("p",[o("strong",[t._v("Manifest File")])]),t._v(" "),o("p",[t._v("The manifest file uses the JSON format and is responsible for declaring various information of the PWA, such as name, description, icon, and shortcut actions.")]),t._v(" "),o("p",[t._v("In order for your site to be registered as a PWA, you need to meet the basic specifications of the manifest to make the browser consider the site as an installable PWA and allow users to install it.")]),t._v(" "),o("div",{staticClass:"custom-block info"},[o("p",{staticClass:"custom-block-title"},[t._v("Info")]),t._v(" "),o("p",[t._v("For Manifest standards and specifications, please see "),o("a",{attrs:{href:"https://w3c.github.io/manifest/",target:"_blank",rel:"noopener noreferrer"}},[t._v("W3C Manifest"),o("OutboundLink")],1)])]),t._v(" "),o("a",{staticClass:"footnote-backref",attrs:{href:"#footnote-ref7"}},[t._v("↩︎")])])])])])}),[],!1,null,null,null);e.default=s.exports},1274:function(t,e,o){"use strict";o.r(e);var a=o(1),s=Object(a.a)({},(function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[o("p",[t._v("默认情况下，该主题将通过内置 "),o("a",{attrs:{href:"https://vuepress-theme-hope.github.io/v1/pwa/zh/",target:"_blank",rel:"noopener noreferrer"}},[o("code",[t._v("vuepress-plugin-pwa1")]),o("OutboundLink")],1),t._v(" 启用渐进式 Web 应用程序支持"),o("sup",{staticClass:"footnote-ref"},[o("a",{attrs:{href:"#footnote1"}},[t._v("[1]")]),o("a",{staticClass:"footnote-anchor",attrs:{id:"footnote-ref1"}})]),t._v("。")]),t._v(" "),o("p",[t._v("如果你不需要此功能或想使用其他 pwa 插件，则可以将 "),o("code",[t._v("themeConfig.pwa")]),t._v(" 设置为 "),o("code",[t._v("false")]),t._v(" 来禁用该插件。")]),t._v(" "),o("h2",{attrs:{id:"内容缓存和更新"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#内容缓存和更新"}},[t._v("#")]),t._v(" 内容缓存和更新")]),t._v(" "),o("p",[t._v("Service Worker "),o("sup",{staticClass:"footnote-ref"},[o("a",{attrs:{href:"#footnote2"}},[t._v("[2]")]),o("a",{staticClass:"footnote-anchor",attrs:{id:"footnote-ref2"}})]),t._v(" (简称 SW) 主要用于获取并托管网站内容。")]),t._v(" "),o("p",[t._v("PWA 插件会自动通过 "),o("code",[t._v("workbox-build")]),t._v(" 注册 Service Woker。")]),t._v(" "),o("p",[t._v("为了更好地控制 Service Worker 可以预缓存的内容，插件提供了下列设置。")]),t._v(" "),o("p",[t._v("如果你是一个高级用户，你也可以直接设置 "),o("code",[t._v("themeConfig.pwa.generateSwConfig")]),t._v(" 来将选项传递给 "),o("code",[t._v("workbox-build")]),t._v("。")]),t._v(" "),o("h3",{attrs:{id:"默认缓存"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#默认缓存"}},[t._v("#")]),t._v(" 默认缓存")]),t._v(" "),o("p",[t._v("默认情况下插件会预缓存所有与网站相关的文件: "),o("code",[t._v("**/*.{html,js,css,svg}")])]),t._v(" "),o("p",[t._v("同时插件还会缓存字体文件: "),o("code",[t._v("**/*.{woff,woff2,eot,ttf,otf}")]),t._v("。")]),t._v(" "),o("h3",{attrs:{id:"缓存控制"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#缓存控制"}},[t._v("#")]),t._v(" 缓存控制")]),t._v(" "),o("p",[t._v("基于可安装性"),o("sup",{staticClass:"footnote-ref"},[o("a",{attrs:{href:"#footnote3"}},[t._v("[3]")]),o("a",{staticClass:"footnote-anchor",attrs:{id:"footnote-ref3"}})]),t._v("的要求，插件提供了缓存控制的相关选项。")]),t._v(" "),o("h4",{attrs:{id:"图片缓存"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#图片缓存"}},[t._v("#")]),t._v(" 图片缓存")]),t._v(" "),o("p",[t._v("你可以通过设置 "),o("code",[t._v("themeConfig.pwa.cachePic")]),t._v(" 选项为 "),o("code",[t._v("true")]),t._v(" 来缓存站点图片。")]),t._v(" "),o("p",[t._v("如果您的站点体积不大，且配图大多为关键性说明，希望可以在离线模式下显示，建议将此项设置为 "),o("code",[t._v("true")]),t._v("。")]),t._v(" "),o("div",{staticClass:"custom-block info"},[o("p",{staticClass:"custom-block-title"},[t._v("图片识别")]),t._v(" "),o("p",[t._v("我们通过文件后缀名识别图片，任何以 "),o("code",[t._v(".png")]),t._v(", "),o("code",[t._v(".jpg")]),t._v(", "),o("code",[t._v(".jpeg")]),t._v(" , "),o("code",[t._v(".gif")]),t._v(", "),o("code",[t._v(".bmp")]),t._v(", "),o("code",[t._v(".webp")]),t._v(" 结尾的文件都会视为图片。")])]),t._v(" "),o("h4",{attrs:{id:"html-缓存"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#html-缓存"}},[t._v("#")]),t._v(" HTML 缓存")]),t._v(" "),o("p",[t._v("当你网站体积过大时，你可以通过设置 "),o("code",[t._v("themeConfig.pwa.cacheHTML")]),t._v(" 为 "),o("code",[t._v("false")]),t._v(" 来仅缓存除主页和 404 错误页。")]),t._v(" "),o("div",{staticClass:"custom-block tip"},[o("p",{staticClass:"custom-block-title"},[t._v("为什么可以移除")]),t._v(" "),o("p",[t._v("虽然说 VuePress 为所有的页面通过 SSR"),o("sup",{staticClass:"footnote-ref"},[o("a",{attrs:{href:"#footnote4"}},[t._v("[4]")]),o("a",{staticClass:"footnote-anchor",attrs:{id:"footnote-ref4"}})]),t._v(" 生成了 HTML 文件，但是这些文件主要用于 SEO"),o("sup",{staticClass:"footnote-ref"},[o("a",{attrs:{href:"#footnote5"}},[t._v("[5]")]),o("a",{staticClass:"footnote-anchor",attrs:{id:"footnote-ref5"}})]),t._v("，并能够让你在后端不做 SPA"),o("sup",{staticClass:"footnote-ref"},[o("a",{attrs:{href:"#footnote6"}},[t._v("[6]")]),o("a",{staticClass:"footnote-anchor",attrs:{id:"footnote-ref6"}})]),t._v(" 配置的情况下能够直接访问任何链接。")]),t._v(" "),o("p",[t._v("VuePress 本质上是一个 SPA。这意味着你只需要缓存主页并从主页进入即可正常访问所有页面。")]),t._v(" "),o("p",[t._v("当你站点页面数量或内容很多，包含 HTML 文件后体积过大时，你可以考虑将此项设置为 "),o("code",[t._v("false")]),t._v("，这样可以缩减大约 40% 的体积。缺点是用户在离线环境下只能通过主页进入再自行导航到对应页面。直接访问某个链接会出现网页错误的提示。")])]),t._v(" "),o("h4",{attrs:{id:"大小控制"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#大小控制"}},[t._v("#")]),t._v(" 大小控制")]),t._v(" "),o("p",[t._v("为了防止在预缓存列表中包含大文件，任何大于 2MB 的文件或大于 1MB 的图片都将被删除。")]),t._v(" "),o("p",[t._v("你可以通过 "),o("code",[t._v("themeConfig.pwa.maxSize")]),t._v(" 选项自定义缓存的最大文件大小 (单位 KB)，或通过 "),o("code",[t._v("themeConfig.pwa.maxPicSize")]),t._v(" 来更改图片的大小限制 (单位: KB)。")]),t._v(" "),o("h3",{attrs:{id:"更新弹窗"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#更新弹窗"}},[t._v("#")]),t._v(" 更新弹窗")]),t._v(" "),o("p",[t._v("成功下载新内容后，我们将提供更新弹出窗口。")]),t._v(" "),o("div",{staticClass:"custom-block tip"},[o("p",{staticClass:"custom-block-title"},[t._v("自定义弹窗")]),t._v(" "),o("p",[t._v("如果你对默认的弹窗不满意，你可以自行编写组件更换。你需要全局注册自己的弹窗组件，并将组件的名称传递给 "),o("code",[t._v("themeConfig.pwa.popupComponent")]),t._v(" 选项。")])]),t._v(" "),o("h2",{attrs:{id:"清单文件生成"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#清单文件生成"}},[t._v("#")]),t._v(" 清单文件生成")]),t._v(" "),o("p",[t._v("为了保证 PWA 的可安装性，网站需要生成清单文件，并通过 "),o("code",[t._v("link")]),t._v(" 声明有效的 manifest 清单文件地址"),o("sup",{staticClass:"footnote-ref"},[o("a",{attrs:{href:"#footnote7"}},[t._v("[7]")]),o("a",{staticClass:"footnote-anchor",attrs:{id:"footnote-ref7"}})]),t._v("。")]),t._v(" "),o("p",[t._v("插件会在输出目录自动为你生成 Manifest 文件 "),o("code",[t._v("manifest.webmanifest")]),t._v("，同时还会添加清单地址声明到每一个 HTML 的 "),o("code",[t._v("<head>")]),t._v(" 中。")]),t._v(" "),o("p",[t._v("如果你在 "),o("code",[t._v(".vuepress/public")]),t._v(" 中已有一个 "),o("code",[t._v("manifest.webmanifest")]),t._v(" 或 "),o("code",[t._v("manifest.json")]),t._v("，该插件将读取它并合并到最终 manifest 中。")]),t._v(" "),o("h3",{attrs:{id:"自动生成"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#自动生成"}},[t._v("#")]),t._v(" 自动生成")]),t._v(" "),o("p",[t._v("插件会尽可能的通过 VuePress 插件接口的信息，为 manifest 的大部分设置项设置 fallback，这意味着即使你无需设置 manifest 的大多数内容。")]),t._v(" "),o("p",[t._v("如果未设置下列选项，它们会按照顺序依次尝试回退到以下预设值。")]),t._v(" "),o("table",[o("thead",[o("tr",[o("th",[t._v("选项")]),t._v(" "),o("th",[t._v("默认值")])])]),t._v(" "),o("tbody",[o("tr",[o("td",[t._v("name")]),t._v(" "),o("td",[o("code",[t._v("siteConfig.title")]),t._v(" || "),o("code",[t._v("themeConfig.title")]),t._v(" || "),o("code",[t._v("'Site'")])])]),t._v(" "),o("tr",[o("td",[t._v("short_name")]),t._v(" "),o("td",[o("code",[t._v("siteConfig.title")]),t._v(" || "),o("code",[t._v("themeConfig.title")]),t._v(" || "),o("code",[t._v("'Site'")])])]),t._v(" "),o("tr",[o("td",[t._v("description")]),t._v(" "),o("td",[o("code",[t._v("siteConfig.description")]),t._v(" || "),o("code",[t._v("themeConfig.description")]),t._v(" || "),o("code",[t._v("'A site built with vuepress-theme-hope'")])])]),t._v(" "),o("tr",[o("td",[t._v("lang")]),t._v(" "),o("td",[o("code",[t._v("siteConfig.locales['/'].lang")]),t._v(" || "),o("code",[t._v("themeConfig.locales['/'].lang")]),t._v(" || "),o("code",[t._v('"en-US"')])])]),t._v(" "),o("tr",[o("td",[t._v("start_url")]),t._v(" "),o("td",[o("code",[t._v("context.base")])])]),t._v(" "),o("tr",[o("td",[t._v("scope")]),t._v(" "),o("td",[o("code",[t._v("context.base")])])]),t._v(" "),o("tr",[o("td",[t._v("display")]),t._v(" "),o("td",[o("code",[t._v('"standalone"')])])]),t._v(" "),o("tr",[o("td",[t._v("theme_color")]),t._v(" "),o("td",[o("code",[t._v('"#46bd87"')])])]),t._v(" "),o("tr",[o("td",[t._v("background_color")]),t._v(" "),o("td",[o("code",[t._v("'#ffffff'")])])]),t._v(" "),o("tr",[o("td",[t._v("orientation")]),t._v(" "),o("td",[o("code",[t._v("'portrait-primary'")])])]),t._v(" "),o("tr",[o("td",[t._v("prefer_related_applications")]),t._v(" "),o("td",[o("code",[t._v("false")])])])])]),t._v(" "),o("p",[t._v("完整的配置项详见 "),o("a",{attrs:{href:"https://github.com/vuepress-theme-hope/vuepress-theme-hope-v1/blob/main/packages/pwa/src/types/manifest.d.ts",target:"_blank",rel:"noopener noreferrer"}},[t._v("Manifest 类型定义文件"),o("OutboundLink")],1)]),t._v(" "),o("h3",{attrs:{id:"手动配置"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#手动配置"}},[t._v("#")]),t._v(" 手动配置")]),t._v(" "),o("p",[t._v("你可以在 "),o("code",[t._v("themeConfig.pwa.manifest")]),t._v(" 选项中手动指定 manifest 的各项内容。")]),t._v(" "),o("div",{staticClass:"custom-block tip"},[o("p",{staticClass:"custom-block-title"},[t._v("优先级")]),t._v(" "),o("p",[o("code",[t._v("themeConfig.pwa.manifest")]),t._v(" 选项的设置具有最高的优先级，之后是 "),o("code",[t._v("public")]),t._v(" 文件夹下可能存在的 manifest 文件。")])]),t._v(" "),o("p",[o("strong",[t._v("你至少应该通过 "),o("code",[t._v("manifest.icons")]),t._v(" 或 PWA 插件中的其他选项设置一个有效的图标。")]),t._v(" 因为这是我们没法默认生成的。")]),t._v(" "),o("div",{staticClass:"custom-block warning"},[o("p",{staticClass:"custom-block-title"},[t._v("注意")]),t._v(" "),o("p",[t._v("可安装性"),o("sup",{staticClass:"footnote-ref"},[o("a",{attrs:{href:"#footnote3"}},[t._v("[3:1]")]),o("a",{staticClass:"footnote-anchor",attrs:{id:"footnote-ref3:1"}})]),t._v("规范要求 manifest 中至少声明一个有效的图标。")]),t._v(" "),o("p",[t._v("所以如果你不配置 "),o("code",[t._v("themeConfig.pwa.manifest.icons")]),t._v("，访问者只能享受到 Service Worker 缓存带来的离线可访问性，而并不能作为 PWA 进行安装。")]),t._v(" "),o("p",[t._v("另外插件并不会处理 manifest 中的任何内容，而是原样输出它们。这意味着如果打算你部署到某个子目录，你则应自行添加 "),o("code",[t._v("base")]),t._v(" 到 manifest 中的相应 URL。")])]),t._v(" "),o("h2",{attrs:{id:"其他选项"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#其他选项"}},[t._v("#")]),t._v(" 其他选项")]),t._v(" "),o("p",[t._v("插件还提供了其他 PWA 相关选项，比如微软磁贴图标与颜色设置，苹果图标等。")]),t._v(" "),o("p",[t._v("你可以酌情根据需要设置它们。详细的选项请见 "),o("a",{attrs:{href:"https://vuepress-theme-hope.github.io/v1/pwa/zh/config.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("PWA 插件配置"),o("OutboundLink")],1),t._v("。")]),t._v(" "),o("h2",{attrs:{id:"相关阅读"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#相关阅读"}},[t._v("#")]),t._v(" 相关阅读")]),t._v(" "),o("p",[t._v("更多内容，请详见:")]),t._v(" "),o("ul",[o("li",[o("a",{attrs:{href:"https://vuepress-theme-hope.github.io/v1/pwa/zh/",target:"_blank",rel:"noopener noreferrer"}},[t._v("PWA 插件文档"),o("OutboundLink")],1)]),t._v(" "),o("li",[o("a",{attrs:{href:"https://web.dev/progressive-web-apps/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Google PWA"),o("OutboundLink")],1)]),t._v(" "),o("li",[o("a",{attrs:{href:"https://developer.mozilla.org/zh-CN/docs/Web/Progressive_web_apps",target:"_blank",rel:"noopener noreferrer"}},[t._v("MDN PWA"),o("OutboundLink")],1)]),t._v(" "),o("li",[o("a",{attrs:{href:"https://w3c.github.io/manifest/",target:"_blank",rel:"noopener noreferrer"}},[t._v("W3C Manifest 规范"),o("OutboundLink")],1)])]),t._v(" "),o("hr",{staticClass:"footnotes-sep"}),t._v(" "),o("section",{staticClass:"footnotes"},[o("ol",{staticClass:"footnotes-list"},[o("li",{staticClass:"footnote-item",attrs:{id:"footnote1"}},[o("p",[o("strong",[t._v("PWA 介绍")])]),t._v(" "),o("p",[t._v("PWA 全称 Progressive Web app，即渐进式网络应用程序，标准由 W3C 规定。")]),t._v(" "),o("p",[t._v("它允许网站通过支持该特性的浏览器将网站作为 App 安装在对应平台上。 "),o("a",{staticClass:"footnote-backref",attrs:{href:"#footnote-ref1"}},[t._v("↩︎")])])]),t._v(" "),o("li",{staticClass:"footnote-item",attrs:{id:"footnote2"}},[o("p",[o("strong",[t._v("Service Worker 简要介绍")])]),t._v(" "),o("ol",[o("li",[o("p",[t._v("Service Worker 会在注册过程中获取注册在其中的所有文件并缓存它们。")])]),t._v(" "),o("li",[o("p",[t._v("注册成功后，Service Worker 激活，并开始代理并控制你的全部请求。")])]),t._v(" "),o("li",[o("p",[t._v("每当你想要通过浏览器发起访问请求后，Service Worker 将会查看其是否存在与自身缓存列表中，若存在则直接返回缓存好的结果，否则调用自身的 fetch 方法进行获取。你可以通过自定义 fetch 方法，来完全控制网页内资源获取请求的结果，比如在离线时提供一个 fallback 的网页。")])]),t._v(" "),o("li",[o("p",[t._v("每次用户重新打开网站时，Service Worker 会向自身注册时的地址发出校验命令，如果检测到新版本的 Service Woker，则会更新自身，并开始缓存注册在新 Service Worker 中的资源列表。成功获取内容更新后，Service Worker 将会触发 "),o("code",[t._v("update")]),t._v(" 事件。可以通过此事件提示用户，比如将在右下角显示一个弹出窗口，提示用户新内容可用并允许用户触发更新。")])])]),t._v(" "),o("a",{staticClass:"footnote-backref",attrs:{href:"#footnote-ref2"}},[t._v("↩︎")])]),t._v(" "),o("li",{staticClass:"footnote-item",attrs:{id:"footnote3"}},[o("p",[o("strong",[t._v("可安装性")])]),t._v(" "),o("p",[t._v("想要让网站可以注册为 PWA，网站需要自行成功注册有效的 Service Worker，同时添加合法的 manifest 清单文件并在网站中声明它。")]),t._v(" "),o("p",[t._v("各平台或浏览器对 Service Worker 缓存的大小有要求，当 Service Worker 缓存的文件体积过大后，该网站将会被标记为不可安装。对于 Safari 这个阈值是 50 MB，少数浏览器会设置更少或更多的值 (30MB, 70MB, 80MB)，最大的 Chrome 也将阈值标识在 100 MB。")]),t._v(" "),o("p",[t._v("另外，清单文件应至少包含 "),o("code",[t._v("name")]),t._v("(或 "),o("code",[t._v("short_name")]),t._v(") "),o("code",[t._v("icons")]),t._v(" "),o("code",[t._v("start_url")]),t._v("。")]),t._v(" "),o("p",[t._v("从 Chrome 93 起 Service Woker 必须含有有效的控制离线请求的 fetch 事件 "),o("a",{staticClass:"footnote-backref",attrs:{href:"#footnote-ref3"}},[t._v("↩︎")]),t._v(" "),o("a",{staticClass:"footnote-backref",attrs:{href:"#footnote-ref3:1"}},[t._v("↩︎")])])]),t._v(" "),o("li",{staticClass:"footnote-item",attrs:{id:"footnote4"}},[o("p",[o("strong",[t._v("SSR")]),t._v(": "),o("strong",[t._v("S")]),t._v("erver "),o("strong",[t._v("S")]),t._v("ide "),o("strong",[t._v("R")]),t._v("endering，服务端渲染 "),o("a",{staticClass:"footnote-backref",attrs:{href:"#footnote-ref4"}},[t._v("↩︎")])])]),t._v(" "),o("li",{staticClass:"footnote-item",attrs:{id:"footnote5"}},[o("p",[o("strong",[t._v("SEO")]),t._v(": "),o("strong",[t._v("S")]),t._v("earch "),o("strong",[t._v("E")]),t._v("ngine "),o("strong",[t._v("O")]),t._v("ptimization，搜索引擎增强，")]),t._v(" "),o("p",[t._v("详见 "),o("a",{attrs:{href:"https://mrhope.site/code/website/html/definition/seo/",target:"_blank",rel:"noopener noreferrer"}},[t._v("SEO 介绍"),o("OutboundLink")],1),t._v(" "),o("a",{staticClass:"footnote-backref",attrs:{href:"#footnote-ref5"}},[t._v("↩︎")])])]),t._v(" "),o("li",{staticClass:"footnote-item",attrs:{id:"footnote6"}},[o("p",[o("strong",[t._v("SPA")]),t._v(": "),o("strong",[t._v("S")]),t._v("ingle "),o("strong",[t._v("P")]),t._v("age "),o("strong",[t._v("A")]),t._v("pplication, 单页应用")]),t._v(" "),o("p",[t._v("大多只有主页，并使用 history mode 处理路由，而不是真的在页面之间导航。 "),o("a",{staticClass:"footnote-backref",attrs:{href:"#footnote-ref6"}},[t._v("↩︎")])])]),t._v(" "),o("li",{staticClass:"footnote-item",attrs:{id:"footnote7"}},[o("p",[o("strong",[t._v("清单文件")])]),t._v(" "),o("p",[t._v("清单文件使用 JSON 格式，负责声明 PWA 各项信息，如名称、描述、图标、快捷动作等。")]),t._v(" "),o("p",[t._v("为了使你的站点能够被注册为 PWA，你需要满足 manifest 基本的规范，才能使浏览器认为该网站为一个可安装的 PWA 并允许用户安装它。")]),t._v(" "),o("div",{staticClass:"custom-block info"},[o("p",{staticClass:"custom-block-title"},[t._v("相关信息")]),t._v(" "),o("p",[t._v("Manifest 的标准与规范，请详见 "),o("a",{attrs:{href:"https://w3c.github.io/manifest/",target:"_blank",rel:"noopener noreferrer"}},[t._v("W3C Manifest"),o("OutboundLink")],1)])]),t._v(" "),o("a",{staticClass:"footnote-backref",attrs:{href:"#footnote-ref7"}},[t._v("↩︎")])])])])])}),[],!1,null,null,null);e.default=s.exports}}]);